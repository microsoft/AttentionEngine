#!/bin/bash

shapes=(
    "4096 4096 4096"
    "4096 1024 4096"
    "4096 14336 4096"
    "4096 4096 14336"
    "64 4096 4096"
    "1 1024 4096"
    "1 14336 4096"
    "1 4096 14336"
    "16 4096 4096"
    "16 1024 4096"
    "16 14336 4096"
    "16 4096 14336"
    "4096 8192 8192"
    "4096 1024 8192"
    "4096 28672 8192"
    "4096 8192 28672"
    "1 8192 8192"
    "1 1024 8192"
    "1 28672 8192"
    "1 8192 28672"
    "16 8192 8192"
    "16 1024 8192"
    "16 28672 8192"
    "16 8192 28672"
)

mkdir -p logs/
for shape in "${shapes[@]}"; do
    read M N K <<< "$shape"
    
    python dequant_gemm_fp4.py --m "$M" --n "$N" --k "$K" 2>&1 | tee "logs/dequant_gemm_${M}_${N}_${K}.log"
done