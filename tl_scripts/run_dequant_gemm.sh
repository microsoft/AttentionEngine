#!/bin/bash

shapes=(
    # "1 1024 4096"
    # "1 4096 4096"
    # "1 14336 4096"
    # "1 4096 14336"
    "64 1024 4096"
    "64 4096 4096"
    "64 14336 4096"
    "64 4096 14336"
    "128 1024 4096"
    "128 4096 4096"
    "128 14336 4096"
    "128 4096 14336"
    # "1 1024 8192"
    # "1 8192 8192"
    # "1 28672 8192"
    # "1 8192 28672"
    "64 1024 8192"
    "64 8192 8192"
    "64 28672 8192"
    "64 8192 28672"
    "128 1024 8192"
    "128 8192 8192"
    "128 28672 8192"
    "128 8192 28672"
)

mkdir -p logs/dequant_gemm
id=0
for shape in "${shapes[@]}"; do
    read M N K <<< "$shape"
    
    python dequant_gemm_fp4.py --m "$M" --n "$N" --k "$K" 2>&1 | tee "logs/dequant_gemm/${id}.${M}_${N}_${K}.log"
    id=$((id + 1))
done