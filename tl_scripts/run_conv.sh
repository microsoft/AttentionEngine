#!/bin/bash

shapes=(
    "1 128 56 56 256 1 1 0 1 1"
    "1 64 56 56 64 3 3 1 1 1"
    "1 64 56 56 64 1 1 0 1 1"
    "1 64 56 56 256 1 1 0 1 1"
    "1 128 28 28 128 3 3 1 1 1"
    "1 128 28 28 512 1 1 0 1 1"
    "128 128 56 56 256 1 1 0 1 1"
    "128 64 56 56 64 3 3 1 1 1"
    "128 64 56 56 64 1 1 0 1 1"
    "128 64 56 56 256 1 1 0 1 1"
    "128 128 28 28 128 3 3 1 1 1"
    "128 128 28 28 512 1 1 0 1 1"
)

mkdir -p logs/
for shape in "${shapes[@]}"; do
    read n c h w inc kw kh p s d <<< "$shape"

    python conv_tune.py \
        --n "$n" \
        --c "$c" \
        --h "$h" \
        --w "$w" \
        --inc "$inc" \
        --kw "$kw" \
        --kh "$kh" \
        --p "$p" \
        --s "$s" \
        --d "$d" \
        2>&1 | tee "logs/conv_${n}_${c}_${h}_${w}_${inc}_${kw}_${kh}_${p}_${s}_${d}.log"
done