#!/bin/bash
shapes=(
    "1 1024 14 14 512 2 2 1 0"
    "1 512 28 28 256 2 2 1 0"
    "1 256 56 56 128 2 2 1 0"
    "1 128 112 112 64 2 2 1 0"
    
    "32 1024 14 14 512 2 2 1 0"
    "32 512 28 28 256 2 2 1 0"
    "32 256 56 56 128 2 2 1 0"
    "32 128 112 112 64 2 2 1 0"

    "128 1024 14 14 512 2 2 1 0"
    "128 512 28 28 256 2 2 1 0"
    "128 256 56 56 128 2 2 1 0"
    "128 128 112 112 64 2 2 1 0"
)

mkdir -p logs/
id=0
for shape in "${shapes[@]}"; do
    read n c h w f k s d p <<< "$shape"

    python conv_transpose_tune.py \
        --n "$n" \
        --c "$c" \
        --h "$h" \
        --w "$w" \
        --f "$f" \
        --k "$k" \
        --s "$s" \
        --d "$d" \
        --p "$p" \
        2>&1 | tee "logs/${id}.conv_transpose_${n}_${c}_${h}_${w}_${f}_${k}_${s}_${d}_${p}.log"
    id=$((id + 1))
done