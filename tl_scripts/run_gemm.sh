#!/bin/bash

shapes=(
    # "4096 4096 4096"
    # "4096 1024 4096"
    # "4096 14336 4096"
    # "4096 4096 14336"
    # "64 4096 4096"
    # "1 1024 4096"
    # "1 14336 4096"
    # "1 4096 14336"
    # "16 4096 4096"
    # "16 1024 4096"
    # "16 14336 4096"
    # "16 4096 14336"
    # "4096 8192 8192"
    # "4096 1024 8192"
    # "4096 28672 8192"
    # "4096 8192 28672"
    # "1 8192 8192"
    # "1 1024 8192"
    # "1 28672 8192"
    # "1 8192 28672"
    # "16 8192 8192"
    # "16 1024 8192"
    # "16 28672 8192"
    # "16 8192 28672"
    "16 6912 1152"
    "4096 3456 1152"
    "4096 1152 1152"
    "4096 4608 1152"
    "4096 1152 4608"
    "16384 3456 1152"
    "16384 1152 1152"
    "16384 4608 1152"
    "16384 1152 4608"
    "64 6912 1152"
    "65536 3456 1152"
    "65536 1152 1152"
    "65536 4608 1152"
    "65536 1152 4608"
)

mkdir -p logs/
for shape in "${shapes[@]}"; do
    read M N K <<< "$shape"
    
    python gemm_example.py --m "$M" --n "$N" --k "$K" 2>&1 | tee "logs/gemm_${M}_${N}_${K}.log"
done